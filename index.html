<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Reserva tu Turno - Alma Est√©tica</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #fbe9f0;
      margin: 0;
      padding: 0;
      display: flex;
      justify-content: center;
      align-items: center;
      min-height: 100vh;
    }

    .container {
      text-align: center;
      padding: 20px;
    }

    form {
      background: white;
      padding: 25px;
      border-radius: 12px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
      max-width: 350px;
      margin: auto;
    }

    input, select, button {
      width: 100%;
      padding: 12px;
      margin: 8px 0;
      border-radius: 8px;
      border: 1px solid #ccc;
      font-size: 16px;
    }

    img {
      width: 160px;
      margin-bottom: 15px;
    }

    h1 {
      color: #c2185b;
      font-size: 26px;
      margin: 10px 0;
    }

    h3 {
      color: #ad1457;
      font-weight: normal;
      font-size: 18px;
    }

    p {
      font-size: 14px;
      color: #555;
    }

    @media (max-width: 480px) {
      form {
        padding: 20px;
        max-width: 90%;
      }
      input, select, button {
        font-size: 15px;
        padding: 10px;
      }
      h1 {
        font-size: 22px;
      }
    }
  </style>
</head>
<body>

<div class="container">
  <img src="logo.jpg" alt="Logo Alma Est√©tica">

  <h1>Alma Est√©tica</h1>
  <h3>Belleza y Bienestar a tu medida</h3>
  <p>Sarmiento 407, Concepci√≥n, Tucum√°n</p>

  <form id="reservaForm">
    <input type="text" id="nombre" placeholder="Tu nombre" required><br>
    <input type="text" id="telefono" placeholder="Tu n√∫mero (sin +54)" required><br>

    <select id="profesional" required>
      <option value="">Seleccion√° un profesional</option>
      <option value="Melanie">Melanie</option>
      <option value="F√°tima">F√°tima</option>
      <option value="Dr. Maria">Dr. Maria</option>
      <option value="Maria">Maria</option>
      <option value="Cris">Cris</option>
      <option value="Alis">Alis</option>
    </select><br>

    <select id="servicio" required>
      <option value="">Seleccion√° un servicio</option>
      <optgroup label="Faciales">
        <option value="Hifu">Hifu</option>
        <option value="Limpieza Facial">Limpieza Facial</option>
        <option value="BB Glow">BB Glow</option>
        <option value="Radiofrecuencia Facial">Radiofrecuencia Facial</option>
      </optgroup>
      <optgroup label="Corporales">
        <option value="Cavitaci√≥n">Cavitaci√≥n</option>
        <option value="Criolip√≥lisis">Criolip√≥lisis</option>
        <option value="Radiofrecuencia Corporal">Radiofrecuencia Corporal</option>
        <option value="Presoterapia">Presoterapia</option>
        <option value="Crioterapia">Crioterapia</option>
        <option value="Ultrasonido Corporal">Ultrasonido Corporal</option>
      </optgroup>
      <optgroup label="Depilaci√≥n L√°ser">
        <option value="L√°ser para eliminar tatuajes">L√°ser para eliminar tatuajes</option>
        <option value="Depilaci√≥n definitiva">Depilaci√≥n definitiva</option>
      </optgroup>
      <optgroup label="Manos y Pies">
        <option value="U√±as">U√±as</option>
        <option value="Manicur√≠a">Manicur√≠a</option>
        <option value="Pedicur√≠a">Pedicur√≠a</option>
        <option value="Belleza de manos y pies">Belleza de manos y pies</option>
      </optgroup>
      <optgroup label="Cejas y Pesta√±as">
        <option value="Pesta√±as">Pesta√±as</option>
        <option value="Lifting de pesta√±as">Lifting de pesta√±as</option>
        <option value="Laminado de cejas">Laminado de cejas</option>
      </optgroup>
      <optgroup label="Peluquer√≠a">
        <option value="Corte de pelo">Corte de pelo</option>
        <option value="Tinturas">Tinturas</option>
        <option value="Coloraciones">Coloraciones</option>
        <option value="Mechas">Mechas</option>
        <option value="Peinados">Peinados</option>
      </optgroup>
    </select><br>

    <input type="date" id="fecha" required><br>
    <input type="time" id="hora" required><br>

    <button type="submit" id="botonEnviar">Reservar Turno</button><br>
    <button type="button" id="buscarTurno">Modificar / Eliminar mi Turno</button>
  </form>
</div>

<script>
  let idTurno = null;
  const url = 'https://script.google.com/macros/s/AKfycbx14SIRVYRHE9TbuNDSd-bJXOfrVBz6F65rG7PHhBHPPXG7fN9LG4E4j3X6SmznDa08/exec';

  document.getElementById('reservaForm').addEventListener('submit', function(e) {
    e.preventDefault();

    const nombre = document.getElementById('nombre').value;
    const telefono = document.getElementById('telefono').value;
    const profesional = document.getElementById('profesional').value;
    const servicio = document.getElementById('servicio').value;
    const fecha = document.getElementById('fecha').value;
    const hora = document.getElementById('hora').value;

    const data = {
      nombre,
      telefono,
      profesional,
      servicio,
      fecha,
      hora
    };

    if (idTurno) {
      data.id = idTurno;
      fetch(url + '?_method=PUT', {
        method: 'POST',
        body: JSON.stringify(data)
      })
      .then(response => {
        if (response.ok) {
          alert("‚úÖ Turno modificado exitosamente!");
          document.getElementById('reservaForm').reset();
          idTurno = null;
        } else {
          alert("‚ùå Error modificando el turno.");
        }
      })
      .catch(error => {
        console.error('Error:', error);
        alert("‚ùå Error modificando el turno.");
      });
    } else {
      fetch(url, {
        method: 'POST',
        body: JSON.stringify(data)
      })
      .then(response => {
        if (response.ok) {
          alert("‚úÖ Reserva enviada exitosamente!");
          document.getElementById('reservaForm').reset();
        } else {
          alert("‚ùå Hubo un problema enviando la reserva.");
        }
      })
      .catch(error => {
        console.error('Error:', error);
        alert("‚ùå Hubo un problema enviando la reserva.");
      });
    }
  });

  document.getElementById('buscarTurno').addEventListener('click', function() {
    const telefono = prompt('Ingres√° tu n√∫mero de tel√©fono para buscar tus turnos:');

    if (!telefono) {
      alert('Deb√©s ingresar un n√∫mero de tel√©fono.');
      return;
    }

    fetch('https://opensheet.elk.sh/15H4TSdJGTZGJS3VEXQ18bhyJWqJ04Ll-h6Y9LPZt30g/Hoja 1')
      .then(response => response.json())
      .then(data => {
        const turnos = data
          .map((t, i) => ({ ...t, fila: i + 2 }))
          .filter(t => t.telefono === telefono);

        if (turnos.length === 0) {
          alert('‚ùå No se encontraron turnos con ese n√∫mero.');
          return;
        }

        const container = document.createElement('div');
        container.style.position = 'fixed';
        container.style.top = '0';
        container.style.left = '0';
        container.style.width = '100%';
        container.style.height = '100%';
        container.style.background = 'rgba(0, 0, 0, 0.5)';
        container.style.zIndex = '9999';
        container.style.overflowY = 'auto';
        container.style.display = 'flex';
        container.style.flexDirection = 'column';
        container.style.alignItems = 'center';
        container.style.justifyContent = 'center';
        container.style.padding = '20px';

        turnos.forEach(turno => {
          const card = document.createElement('div');
          card.style.background = 'white';
          card.style.borderRadius = '12px';
          card.style.boxShadow = '0 4px 10px rgba(0,0,0,0.2)';
          card.style.margin = '10px';
          card.style.padding = '20px';
          card.style.maxWidth = '350px';
          card.style.width = '100%';
          card.style.textAlign = 'left';
          card.style.fontSize = '16px';

          card.innerHTML = `
            <strong>Nombre:</strong> ${turno.nombre}<br>
            <strong>Profesional:</strong> ${turno.profesional}<br>
            <strong>Servicio:</strong> ${turno.servicio}<br>
            <strong>Fecha:</strong> ${turno.fecha}<br>
            <strong>Hora:</strong> ${turno.hora}<br><br>
          `;

          const btns = document.createElement('div');
          btns.style.display = 'flex';
          btns.style.justifyContent = 'space-between';
          btns.style.gap = '10px';

          const btnEditar = document.createElement('button');
          btnEditar.textContent = 'Modificar';
          btnEditar.style.flex = '1';
          btnEditar.style.background = '#c2185b';
          btnEditar.style.color = 'white';
          btnEditar.style.border = 'none';
          btnEditar.style.borderRadius = '8px';
          btnEditar.style.padding = '10px';
          btnEditar.onclick = () => {
            idTurno = turno.fila;
            document.getElementById('nombre').value = turno.nombre;
            document.getElementById('telefono').value = turno.telefono;
            document.getElementById('profesional').value = turno.profesional;
            document.getElementById('servicio').value = turno.servicio;
            document.getElementById('fecha').value = turno.fecha;
            document.getElementById('hora').value = turno.hora;
            alert('‚úÖ Ahora pod√©s modificar el turno y apretar "Reservar Turno".');
            document.body.removeChild(container);
          };

          const btnEliminar = document.createElement('button');
          btnEliminar.textContent = 'Eliminar';
          btnEliminar.style.flex = '1';
          btnEliminar.style.background = '#b71c1c';
          btnEliminar.style.color = 'white';
          btnEliminar.style.border = 'none';
          btnEliminar.style.borderRadius = '8px';
          btnEliminar.style.padding = '10px';
          btnEliminar.onclick = () => {
            if (confirm('¬øEst√°s seguro de eliminar este turno?')) {
              fetch(url + '?_method=DELETE', {
                method: 'POST',
                body: JSON.stringify({ id: turno.fila })
              })
              .then(response => {
                if (response.ok) {
                  alert('üóëÔ∏è Turno eliminado.');
                  document.body.removeChild(container);
                  document.getElementById('reservaForm').reset();
                  idTurno = null;
                } else {
                  alert('‚ùå Error al eliminar el turno.');
                }
              })
              .catch(error => {
                console.error('Error:', error);
                alert('‚ùå Error al eliminar el turno.');
              });
            }
          };

          btns.appendChild(btnEditar);
          btns.appendChild(btnEliminar);
          card.appendChild(btns);
          container.appendChild(card);
        });

        const cerrar = document.createElement('button');
        cerrar.textContent = 'Cerrar';
        cerrar.style.marginTop = '20px';
        cerrar.style.padding = '10px 20px';
        cerrar.style.background = '#555';
        cerrar.style.color = 'white';
        cerrar.style.border = 'none';
        cerrar.style.borderRadius = '8px';
        cerrar.onclick = () => document.body.removeChild(container);

        container.appendChild(cerrar);
        document.body.appendChild(container);
      })
      .catch(error => {
        console.error('Error:', error);
        alert('‚ùå Error buscando el turno.');
      });
  });
</script>



</body>
</html>
